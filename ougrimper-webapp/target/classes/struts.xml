<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
        "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>
	<package name="default" extends="struts-default">
		<!-- Action par défaut -->
		<default-action-ref name="index" />

		<!-- Action "index" -->
		<action name="index">
			<result>/jsp/index.jsp</result>
		</action>

		<!-- Action listant les sites d'escalade -->
		<action name="site_list"
			class="org.driss.ougrimper.webapp.action.GestionSiteAction"
			method="doList">
			<result>/jsp/frontoffice/listSite.jsp</result>
		</action>

		<!-- Action affichant le détail d'un site d'escalade -->
		<action name="site_detail"
			class="org.driss.ougrimper.webapp.action.GestionSiteAction"
			method="doDetail">
			<interceptor-ref name="store">
				<param name="operationMode">RETRIEVE</param>
			</interceptor-ref>
			<interceptor-ref name="defaultStack" />

			<result>/jsp/frontoffice/site-detail.jsp</result>
		</action>

		<!-- Action permettant de poster un commentaire sur un site d'escalade -->
		<action name="addNewComment"
			class="org.driss.ougrimper.webapp.action.GestionSiteAction"
			method="doAddNewComment">
			<result name="success" type="redirectAction">
				<param name="actionName">comment_list</param>
				<param name="id">${site.id}</param>
			</result>
		</action>

		<!-- Action listant les commentaires sur les sites d'escalade -->
		<action name="comment_list"
			class="org.driss.ougrimper.webapp.action.GestionSiteAction"
			method="doListComment">
			<result>/jsp/frontoffice/listComment.jsp</result>
		</action>
		
		<!-- Action permettant de reserver un topo d'escalade -->
		<action name="addNewReservation"
			class="org.driss.ougrimper.webapp.action.GestionTopoAction"
			method="doAddNewReservation">
			<result name="success" type="redirectAction">
				<param name="actionName">reservation_list</param>
				<param name="id">${topo.id}</param>
			</result>
		</action>
		
		<!-- Action listant les réservations des topos d'escalade -->
		<action name="reservation_list"
			class="org.driss.ougrimper.webapp.action.GestionTopoAction"
			method="doListReservation">
			<result>/jsp/frontoffice/listReservation.jsp</result>
		</action>

		<!-- Action listant les topos de sites d'escalade -->
		<action name="topo_list"
			class="org.driss.ougrimper.webapp.action.GestionTopoAction"
			method="doList">
			<result>/jsp/frontoffice/listTopo.jsp</result>
		</action>

		<!-- Action affichant le détail d'un topo de site d'escalade -->
		<action name="topo_detail"
			class="org.driss.ougrimper.webapp.action.GestionTopoAction"
			method="doDetail">
			<interceptor-ref name="store">
				<param name="operationMode">RETRIEVE</param>
			</interceptor-ref>
			<interceptor-ref name="defaultStack" />

			<result>/jsp/frontoffice/topo-detail.jsp</result>
		</action>

		<!-- Actions Login/Logout -->
		<action name="login"
			class="org.driss.ougrimper.webapp.action.LoginAction"
			method="doLogin">

			<interceptor-ref name="store">
				<param name="operationMode">RETRIEVE</param>
			</interceptor-ref>
			<interceptor-ref name="defaultStack" />

			<result name="input">/jsp/frontoffice/connexion.jsp</result>
			<result name="success" type="redirectAction">index</result>
		</action>
		<action name="logout"
			class="org.driss.ougrimper.webapp.action.LoginAction"
			method="doLogout">
			<result type="redirectAction">index</result>
		</action>

		<!-- Actions permettant de créer un nouvel utilisateur -->
		<action name="inscription"
			class="org.driss.ougrimper.webapp.action.GestionUtilisateurAction"
			method="doCreate">

			<interceptor-ref name="store">
				<param name="operationMode">STORE</param>
			</interceptor-ref>
			<interceptor-ref name="defaultStack" />

			<result name="input">/jsp/frontoffice/inscription.jsp</result>
			<result name="success" type="redirectAction">
				<param name="actionName">index</param>
			</result>
		</action>
	</package>

	<!-- ===== Package pour les actions AJAX ===== -->
	<package name="ajax" extends="struts-default, json-default">
	
		<global-results>
			<result name="error" type="json">
				<param name="statusCode">400</param>
				<param name="includeProperties">actionErrors.*,fieldErrors.*</param>
				<!-- Pour accéder au attributs des classes parentes à la classe d'action -->
				<param name="ignoreHierarchy">false</param>
			</result>
		</global-results>
		
		<!-- Action renvoyant la liste des Voies d'un Secteur -->
        <action name="demo_ajax_getListVoie"
                class="org.driss.ougrimper.webapp.action.GestionSiteAction"
                method="doAjaxGetListVoie">
            <result name="success" type="json">
                <param name="root">listVoie</param>
            </result>
        </action>
	</package>
</struts>